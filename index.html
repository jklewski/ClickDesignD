<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">

  <!-- Boostrap-->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

  <!-- load leaflet-->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""> </script>
  <!-- import leaflet map-providers (use a free one w/o tokens)-->
  <script src="leaflet-providers.js"></script>

  <script>
    $(document).ready(function () {
      $("#table tr").click(function () {
        $(this).addClass('selected').siblings().removeClass('selected');
        var value = $(this).find('td:first').html();
        alert(value);
      });
    })
  </script>

  <!-- data in-->
  <script>
    var materialResistance = []
    const xhttp = new XMLHttpRequest();
    xhttp.onload = function () {
      materialResistance = JSON.parse(this.responseText)
    }
    xhttp.open("GET", "./assets/materialResistance.json", false);
    xhttp.send();
  </script>
</head>

<body>
  <br>

  <div class="container">
    <ul class="nav nav-tabs">
      <li class="active"><a data-toggle="tab" href="#home">Location</a></li>
      <li><a data-toggle="tab" href="#menu1">Local conditions</a></li>
      <li><a data-toggle="tab" href="#menu2">Detailing</a></li>
      <li><a data-toggle="tab" href="#menu3">Shelter</a></li>
      <li><a data-toggle="tab" href="#menu4">Material</a></li>
    </ul>

    <div class="tab-content">
      <div id="home" class="tab-pane fade in active">
        <h3>Geographic location</h3>
        <p>The location of your planned or existing project will affect the
          service life of wooden material that is exposed to water.
          This effect has been considered by modelling the durability of a reference board in
          multiple climates across Europe. <br><br>
          Drag the pin to a location on the map.</p>
        <div id="map"
          style="height:300px; width:90%; margin-left:auto; margin-right:auto; margin-top:20px;border-style: solid;">
        </div>
        <p id="D_ref"><b>D<sub>ref</sub> = 26 dosedays</b></p>
      </div>

      <!-- 2ND MENU-->
      <div id="menu1" class="tab-pane fade">
        <h3>Local conditions/terrain</h3>
        <div class="card bg-dark text-white">
          <p>The surrounding terrain and topography will affect the local conditions at the
            location for the project. Local conditions can affect drying conditions
            (through for example shading) or exposure to precipitation (through e.g. shelter from
            buildings).</p>
          <form id="form1" onchange="k1_func()">
            <p>Select local conditions:</p>
            <input type="radio" id="top1" name="topography" value="open" checked>
            <label for="open">Open field</label><br>
            <input type="radio" id="top2" name="topography" value="forest">
            <label for="forest">Forest</label><br>
            <input type="radio" id="top3" name="topography" value="sheltered">
            <label for="sheltered">Sheltered by buildings</label>
          </form>
          <br>
          <p id="k1text"><b>k<sub>1</sub> = 1.0</b></p>
        </div>
      </div>

      <!-- 3RD MENU-->
      <div id="menu2" class="tab-pane fade">
        <h3>Geometry & Contact faces</h3>
        <p>Exposed end-grain tend to absorb more water than exposed side-grain. As
          a result, decay often starts near exposed end-grain.</p>
        <form id="form2" onchange="k2_func()">
          <input type="radio" id="abs1" name="absorp" value="side-grain" checked>
          <label for="side-grain">Side-grain</label><br>
          <input type="radio" id="abs2" name="absorp" value="end-grain">
          <label for="end-grain">End-grain</label><br>
          <br>
          <p>Detailing where different components intersect and join are often problematic
            as they attract dirt and prevent water from drying out.</p>

          <input type="radio" id="contact1" name="contact" value="contact1" checked>
          <label for="contact1">No contact face or gap size >5 mm free from dirt</label><br>
          <input type="radio" id="contact2" name="contact" value="contact2">
          <label for="contact2">Partially ventilated contact face free from dirt</label><br>
          <input type="radio" id="contact3" name="contact" value="contact3">
          <label for="contact3">Direct contact or insufficient ventilation</label><br>
        </form>
        <br>
        <img id="img" src=".\images\sidegrain_free.png" width="100" border: 5px solid #555;>
      </div>

      <!-- 4TH MENU-->
      <div id="menu3" class="tab-pane fade">
        <h3>Sheltering</h3>
        <p class="card-text">The term shelter is here used to describe any effect which is may reduce the
          duration of wetting of a <i>horizontal</i> wood surface.
          A roof overhang has an obvious sheltering effect on the cladding of a wall, but simply orienting
          a wooden product vertically will reduce the duration of wetting and thereby increase service
          life.</p>
      </div>
      <div id="menu4" class="tab-pane fade">
        <h3>Material/Treatment</h3>


      </div>
    </div>
  </div>





  <script>
    var map = L.map('map').setView([55, 15], 3);
    L.tileLayer.provider('Stamen.Terrain').addTo(map);
    var marker = L.marker([51.5, -0.09], { draggable: 'true' }).addTo(map);
    //marker._latlng
</script>
  <script>

    function k1_func() {
      var f1 = document.getElementById("form1")
      if (f1[0].checked) {
        var k1 = 1
      } else if (f1[1].checked) {
        var k1 = 1.2
      } else if (f1[2].checked) {
        var k1 = 1.4
      }
      console.log(k1)
      document.getElementById("k1text").innerHTML = "<b>k<sub>1</sub> = " + k1 + "</b>"
      return k1
    }
    function k2_func() {
      var f2 = document.getElementById("form2")
      if (f2[0].checked && f2[2].checked) {
        var k2 = 1
        document.getElementById("img").src = "./images/sidegrain_free.png"
      } else if (f2[0].checked && f2[3].checked) {
        var k2 = 1.5
        document.getElementById("img").src = "./images7sidegrain_vented.png"
      } else if (f2[0].checked && f2[4].checked) {
        var k2 = 1.8
        document.getElementById("img").src = "./images/sidegrain_contact.png"
      } else if (f2[1].checked && f2[2].checked) {
        var k2 = 1.5
        document.getElementById("img").src = "./images/endgrain_free.png"
      } else if (f2[1].checked && f2[3].checked) {
        var k2 = 1.8
        document.getElementById("img").src = "./images/endgrain_vented.png"
      } else if (f2[1].checked && f2[4].checked) {
        var k2 = 2.5
        document.getElementById("img").src = "./images/endgrain_contact.png"
      }
      console.log(k2)
      document.getElementById("k2text").innerHTML = "<b>k<sub>1</sub> = " + k2 + "</b>"
      return k2
    }
  </script>

<!-- add material table to tab-->
<script>
  var searchField = document.createElement("input")
  searchField.type = 'text';
  searchField.id = 'myInput';
  searchField.placeholder = 'Search for names...';
  
  searchField.onkeyup = function() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("myInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("table");
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
      td = tr[i].getElementsByTagName("td")[0];
      if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
          tr[i].style.display = "";
        } else {
          tr[i].style.display = "none";
        }
      }       
    }
  }

  const body = document.body;
  divBody = document.createElement('div')
  divBody.style = "height: 200px; overflow-y:auto;"
  tbl = document.createElement('table');
  tbl.style.border = '1px solid black';
  tbl.id = 'table';

  var header = tbl.createTHead();
  var row = header.insertRow(0);    
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);
  
  cell1.innerHTML = "<b>Name</b>"; 
  cell2.innerHTML = "<b>Latin name</b>"; 
  cell3.innerHTML = "<b>Treatment</b>"; 
  cell4.innerHTML = "<b>D<sub>Rd</sub></b>"; 

  tblBody = document.createElement("tbody");
  for (let i = 0; i < materialResistance.length; i++) {
    const tr = tblBody.insertRow();
    tr.style.border = '1px solid black';
    tr.name = 'test'
    const td = tr.insertCell();
    const td2 = tr.insertCell();
    const td3 = tr.insertCell();
    const td4 = tr.insertCell();

    td.innerHTML = materialResistance[i].name
    td2.innerHTML = "<i>" +materialResistance[i].latinName + "</i>"
    td3.innerHTML = materialResistance[i].treatment
    td4.innerHTML = Math.round(materialResistance[i].resistanceDose)
  }
    
  tbl.appendChild(tblBody)
  divBody.appendChild(searchField)
  divBody.appendChild(tbl);
  prnt = document.getElementById("menu4")
  prnt.appendChild(divBody);
</script>
</body>

</html>